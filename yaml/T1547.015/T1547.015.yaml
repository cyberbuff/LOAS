name: "Boot or Logon Autostart Execution: Login Items"
tests:
  - name: Create a login item
    language: AppleScript
    references:
      - https://archive.orkl.eu/572da6b9974916ae9ca7e6887dc4add938f17642.pdf
    description: Creates a new login item that will automatically start when the user logs in.
    tcc_required: true
    command: |
      tell application "System Events" to make login item at end with properties {path:"#{itemPath}", hidden:"#{isHidden}"}
    args:
      itemPath: "/System/Applications/Calculator.app"
      isHidden: false

  - name: Discover login items
    language: AppleScript
    references:
      - https://archive.orkl.eu/572da6b9974916ae9ca7e6887dc4add938f17642.pdf
    description: Lists all login items.
    tcc_required: true
    command: |-
      tell application "System Events" to get name of every login item
      tell application "System Events" to get the hidden of every login item
      tell application "System Events" to get the path of every login item
