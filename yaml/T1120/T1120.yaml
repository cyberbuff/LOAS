name: Peripheral Device Discovery
tests:
  - name: Find removable storage devices using System Events
    description: This test uses System Events to find all connected removable storage devices.
    language: AppleScript
    tcc_required: true
    command: |
      tell application "System Events" to get name of every disk whose ejectable is true

  - name: Find removable storage devices using Finder
    description: This test uses Finder to find all connected removable storage devices.
    language: AppleScript
    tcc_required: true
    command: |
      tell application "Finder" to get name of every disk whose ejectable is true

  - name: Find all devices using System Information
    description: This test uses System Information to find all connected devices (bluetooth, wifi, disks, application versions, etc.).
    language: AppleScript
    tcc_required: true
    command: |-
      tell application "System Information" to get properties
