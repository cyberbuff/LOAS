name: File and Directory Discovery
tests:
  - name: Copy files from desktop
    guid: 019a8de9-49b1-7352-a601-f5f2e52b859d
    description: FileGrabber grabs files from desktop and copies them to a temporary folder
    references:
      - https://research.checkpoint.com/2025/banshee-macos-stealer-that-stole-code-from-macos-xprotect
    language: AppleScript
    command: |
      set fileGrabberFolderPath to "#{destinationPath}"
      set extensionsList to {"txt", "docx", "rtf", "doc", "wallet", "keys", "key", "env", "md", "kdbx"}

      try
       	set desktopFiles to every file of desktop
       	repeat with aFile in desktopFiles
        		try
       			  set fileExtension to name extension of aFile
         			if fileExtension is in extensionsList then
        				set fileSize to size of aFile
        				if fileSize < 51200 then
         					set destinationFolder to (POSIX file fileGrabberFolderPath) as alias
         					duplicate aFile to destinationFolder with replacing
        				end if
         			end if
        		end try
       	end repeat
      end try
    args:
      destinationPath: "/tmp/FileGrabber"

  - name: List files and directories in Macintosh HD
    guid: 019a8de9-49b1-7352-a601-f5f366ac4d2e
    description: Enumerate files and directories in the root filesystem using Finder application via AppleScript
    language: AppleScript
    tcc_required: true
    command: |
      tell application "Finder" to get name of every item of folder POSIX file "#{folderName}"
    args:
      folderName: "/"

  - name: List files and directories in root directory
    guid: 019a8de9-49b1-7352-a601-f5f43e6329e9
    description: Perform directory listing of root filesystem using AppleScript list folder command
    language: AppleScript
    command: |
      list folder "#{folderName}"
    args:
      folderName: "/"
