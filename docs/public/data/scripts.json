[
  {
    "name": "Shutdown system (using System Events)",
    "command": "tell application \"System Events\" to shutdown",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Shuts down the system using the shutdown command from System Events.",
    "technique_id": "T1529",
    "technique_name": "System Shutdown/Reboot",
    "test_number": 1
  },
  {
    "name": "Delete a login item",
    "command": "tell application \"System Events\" to delete login item \"#{loginItemName}\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Removes a specified login item from the user's login items list. This can be used to clean up persistence mechanisms or remove unwanted autostart entries.",
    "technique_id": "T1070.009",
    "technique_name": "Indicator Removal: Clear Persistence",
    "test_number": 1
  },
  {
    "name": "Get system information",
    "command": "return (system info)\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves comprehensive system information including OS version, hardware details, and system configuration using the system info command. This provides detailed system reconnaissance capabilities without requiring elevated privileges.",
    "technique_id": "T1082",
    "technique_name": "System Information Discovery",
    "test_number": 1
  },
  {
    "name": "Get disks",
    "command": "return (list disks)",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Lists all connected disks on the system using the list disks command.",
    "technique_id": "T1082",
    "technique_name": "System Information Discovery",
    "test_number": 2
  },
  {
    "name": "Get all processes",
    "command": "tell application \"System Events\" to get name of every process\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves a list of all running processes on the system using System Events. This provides comprehensive process enumeration capabilities and may require TCC approval for System Events access.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 1
  },
  {
    "name": "Get all application processes (User facing applications)",
    "command": "tell application \"System Events\"\n  set runningApps to name of every application process\n  repeat with appName in runningApps\n    log appName\n  end repeat\nend tell",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves only user-facing application processes (excluding system processes and daemons). This focuses on applications that users typically interact with and may require TCC approval for System Events access.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 2
  },
  {
    "name": "Create a login item",
    "command": "tell application \"System Events\" to make login item at end with properties {path:\"#{itemPath}\", hidden:\"#{isHidden}\"}\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Creates a new login item that will automatically start when the user logs in.",
    "technique_id": "T1547.015",
    "technique_name": "Boot or Logon Autostart Execution: Login Items",
    "test_number": 1
  },
  {
    "name": "Get user (using System Info)",
    "command": "short user name of (system info)\nlong user name of (system info)\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current user's short and long names using the system info command.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 1
  },
  {
    "name": "Get user (using environment variable)",
    "command": "return (system attribute \"USER\")\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current user's username using the USER environment variable.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 2
  },
  {
    "name": "Get user (using list folder)",
    "command": "return (list folder \"/Users\")",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "By default, the user's home directory is /Users/username.\nListing the /Users folder will return the list of users on the system.\n",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 3
  },
  {
    "name": "Get user information (using System Events JXA)",
    "command": "const app = Application(\"System Events\")\nconst user = app.currentUser();\nconst longName = user.fullName();\nconst shortName = user.name();\nconst userHome = user.homeDirectory();\n\n`Name: ${longName}\nUsername: ${shortName}\nHome Directory: ${userHome}`",
    "language": "JavaScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves the current user's username using the System Events JXA command.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 4
  },
  {
    "name": "Get clipboard content (using System Events)",
    "command": "tell application \"System Events\" to get the clipboard",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves the current clipboard content using System Events.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 1
  },
  {
    "name": "Set clipboard content (using System Events)",
    "command": "tell application \"System Events\" to set the clipboard to \"#{clipboardContent}\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Sets the clipboard content to a specified value using System Events.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 2
  },
  {
    "name": "Get clipboard content (using AppleScript defaults)",
    "command": "the clipboard",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current clipboard content using AppleScript's built-in clipboard command.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 3
  },
  {
    "name": "Set clipboard content (using AppleScript defaults)",
    "command": "set the clipboard to \"#{textContent}\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Sets the clipboard content to a specified value using AppleScript's built-in clipboard command.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 4
  },
  {
    "name": "Get clipboard content (using Cocoa)",
    "command": "use framework \"Foundation\"\nuse framework \"AppKit\"\n\nset pasteboard to current application's NSPasteboard's generalPasteboard()\nset clipboardContent to pasteboard's stringForType:\"public.utf8-plain-text\"\nclipboardContent\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves clipboard content using Cocoa frameworks (Foundation and AppKit).",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 5
  },
  {
    "name": "Set clipboard content (using Cocoa)",
    "command": "use framework \"Foundation\"\nuse framework \"AppKit\"\n\nset pasteboard to current application's NSPasteboard's generalPasteboard()\npasteboard's setString:\"#{textContent}\" forType:\"public.utf8-plain-text\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Sets clipboard content using Cocoa frameworks (Foundation and AppKit).",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 6
  }
]
