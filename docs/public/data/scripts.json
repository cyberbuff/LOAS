[
  {
    "name": "Shutdown system (using System Events)",
    "command": "tell application \"System Events\" to shutdown",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Shuts down the system using the shutdown command from System Events.",
    "technique_id": "T1529",
    "technique_name": "System Shutdown/Reboot",
    "test_number": 1
  },
  {
    "name": "Reboot system (using System Events)",
    "command": "tell application \"System Events\" to reboot",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Reboots the system using the reboot command from System Events.",
    "technique_id": "T1529",
    "technique_name": "System Shutdown/Reboot",
    "test_number": 2
  },
  {
    "name": "Delete a login item",
    "command": "tell application \"System Events\" to delete login item \"#{loginItemName}\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Removes a specified login item from the user's login items list. This can be used to clean up persistence mechanisms or remove unwanted autostart entries.",
    "technique_id": "T1070.009",
    "technique_name": "Indicator Removal: Clear Persistence",
    "test_number": 1
  },
  {
    "name": "List files and directories",
    "command": "tell application \"Finder\" to get name of every file in \"#{folderName}\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "List files and directories using System Events",
    "technique_id": "T1083",
    "technique_name": "File and Directory Discovery",
    "test_number": 1
  },
  {
    "name": "Get system information",
    "command": "return (system info)\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves comprehensive system information including OS version, hardware details, and system configuration using the system info command. This provides detailed system reconnaissance capabilities without requiring elevated privileges.",
    "technique_id": "T1082",
    "technique_name": "System Information Discovery",
    "test_number": 1
  },
  {
    "name": "Get disks",
    "command": "return (list disks)",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Lists all connected disks on the system using the list disks command.",
    "technique_id": "T1082",
    "technique_name": "System Information Discovery",
    "test_number": 2
  },
  {
    "name": "Get all processes",
    "command": "tell application \"System Events\" to get name of every process\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves a list of all running processes on the system using System Events. This provides comprehensive process enumeration capabilities and may require TCC approval for System Events access.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 1
  },
  {
    "name": "Get all application processes (User facing applications)",
    "command": "tell application \"System Events\"\n  set runningApps to name of every application process\n  repeat with appName in runningApps\n    log appName\n  end repeat\nend tell",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves only user-facing application processes (excluding system processes and daemons). This focuses on applications that users typically interact with and may require TCC approval for System Events access.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 2
  },
  {
    "name": "Get list of running processes using AppKit",
    "command": "use framework \"AppKit\"\nuse framework \"Foundation\"\n\nset r to {}\nset activeApps to current application's NSWorkspace's sharedWorkspace's runningApplications()\nrepeat with anApp in activeApps\n    try\n        set this_app to anApp's localizedName() as text\n        if this_app is not missing value and this_app is not \"\" then\n            set end of r to this_app\n        end if\n    on error\n        -- Skip apps without names\n    end try\nend repeat\nreturn r",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves running applications using AppKit framework.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 3
  },
  {
    "name": "Enumerate Local Accounts",
    "command": "tell application \"System Events\" to get name of every user\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Adversaries may attempt to get a listing of local system accounts.",
    "technique_id": "T1087.001",
    "technique_name": "Account Discovery: Local Account",
    "test_number": 1
  },
  {
    "name": "Create a login item",
    "command": "tell application \"System Events\" to make login item at end with properties {path:\"#{itemPath}\", hidden:\"#{isHidden}\"}\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Creates a new login item that will automatically start when the user logs in.",
    "technique_id": "T1547.015",
    "technique_name": "Boot or Logon Autostart Execution: Login Items",
    "test_number": 1
  },
  {
    "name": "Discover login items",
    "command": "tell application \"System Events\" to get name of every login item\ntell application \"System Events\" to get the hidden of every login item\ntell application \"System Events\" to get the path of every login item",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Lists all login items.",
    "technique_id": "T1547.015",
    "technique_name": "Boot or Logon Autostart Execution: Login Items",
    "test_number": 2
  },
  {
    "name": "Get user (using System Info)",
    "command": "short user name of (system info)\nlong user name of (system info)\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current user's short and long names using the system info command.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 1
  },
  {
    "name": "Get user (using environment variable)",
    "command": "return (system attribute \"USER\")\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current user's username using the USER environment variable.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 2
  },
  {
    "name": "Get user (using list folder)",
    "command": "return (list folder \"/Users\")",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "By default, the user's home directory is /Users/username.\nListing the /Users folder will return the list of users on the system.\n",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 3
  },
  {
    "name": "Get user information (using System Events JXA)",
    "command": "const app = Application(\"System Events\")\nconst user = app.currentUser();\nconst longName = user.fullName();\nconst shortName = user.name();\nconst userHome = user.homeDirectory();\n\n`Name: ${longName}\nUsername: ${shortName}\nHome Directory: ${userHome}`",
    "language": "JavaScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves the current user's username using the System Events JXA command.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 4
  },
  {
    "name": "Hide Application Window",
    "command": "tell application \"#{applicationName}\" to set visible of front window to false\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Hides the Application window",
    "technique_id": "T1564.003",
    "technique_name": "Hide Artifacts: Hidden Window",
    "test_number": 1
  },
  {
    "name": "Get System Time",
    "command": "current date\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "An adversary may gather the system time and/or time zone settings from a local or remote system.",
    "technique_id": "T1124",
    "technique_name": "System Time Discovery",
    "test_number": 1
  },
  {
    "name": "Get clipboard content (using System Events)",
    "command": "tell application \"System Events\" to get the clipboard",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves the current clipboard content using System Events.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 1
  },
  {
    "name": "Set clipboard content (using System Events)",
    "command": "tell application \"System Events\" to set the clipboard to \"#{clipboardContent}\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Sets the clipboard content to a specified value using System Events.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 2
  },
  {
    "name": "Get clipboard content (using AppleScript defaults)",
    "command": "the clipboard",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current clipboard content using AppleScript's built-in clipboard command.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 3
  },
  {
    "name": "Set clipboard content (using AppleScript defaults)",
    "command": "set the clipboard to \"#{textContent}\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Sets the clipboard content to a specified value using AppleScript's built-in clipboard command.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 4
  },
  {
    "name": "Get clipboard content (using Cocoa)",
    "command": "use framework \"Foundation\"\nuse framework \"AppKit\"\n\nset pasteboard to current application's NSPasteboard's generalPasteboard()\nset clipboardContent to pasteboard's stringForType:\"public.utf8-plain-text\"\nclipboardContent\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves clipboard content using Cocoa frameworks (Foundation and AppKit).",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 5
  },
  {
    "name": "Set clipboard content (using Cocoa)",
    "command": "use framework \"Foundation\"\nuse framework \"AppKit\"\n\nset pasteboard to current application's NSPasteboard's generalPasteboard()\npasteboard's setString:\"#{textContent}\" forType:\"public.utf8-plain-text\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Sets clipboard content using Cocoa frameworks (Foundation and AppKit).",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 6
  },
  {
    "name": "Take screenshot",
    "command": "tell application \"System Events\" to key code 20 using {command down, shift down}",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Capture screenshot using System Events",
    "technique_id": "T1113",
    "technique_name": "Input Capture",
    "test_number": 1
  },
  {
    "name": "Display dialog box to capture user password",
    "command": "display dialog \"#{description}\" with title \"#{title}\" default answer \"\" with icon caution buttons {\"Continue\"} default button \"Continue\" with hidden answer\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Removes a specified login item from the user's login items list. This can be used to clean up persistence mechanisms or remove unwanted autostart entries.",
    "technique_id": "T1059.002",
    "technique_name": "Command and Scripting Interpreter: AppleScript",
    "test_number": 1
  },
  {
    "name": "Open application",
    "command": "tell application \"#{applicationName}\" to activate\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Opens an application on the system. The application will be in focus after running the command.",
    "technique_id": "T1059.002",
    "technique_name": "Command and Scripting Interpreter: AppleScript",
    "test_number": 2
  },
  {
    "name": "Launch application",
    "command": "tell application \"#{applicationName}\" to launch\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Lauches an application on the system. The application will be in the background after running the command.",
    "technique_id": "T1059.002",
    "technique_name": "Command and Scripting Interpreter: AppleScript",
    "test_number": 3
  },
  {
    "name": "Close application",
    "command": "tell application \"#{applicationName}\" to close windows\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Closes an application on the system.",
    "technique_id": "T1059.002",
    "technique_name": "Command and Scripting Interpreter: AppleScript",
    "test_number": 4
  },
  {
    "name": "Stop Application",
    "command": "tell application \"#{applicationName}\" to quit\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Adversaries may stop or disable services on a system to render those services unavailable to legitimate users",
    "technique_id": "T1489",
    "technique_name": "Service Stop",
    "test_number": 1
  }
]