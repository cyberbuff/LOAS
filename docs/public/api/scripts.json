[
  {
    "name": "Get System Locale",
    "command": "get user locale of (system info)",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "An adversary may gather the system locale settings in order to infer the geographical location of that host.",
    "technique_id": "T1614.001",
    "technique_name": "System Location Discovery: System Language Discovery",
    "test_number": 1
  },
  {
    "name": "Get System Language using env variable",
    "command": "system attribute \"LANG\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "An adversary may gather the system language settings from the LANG environment variable.",
    "technique_id": "T1614.001",
    "technique_name": "System Location Discovery: System Language Discovery",
    "test_number": 2
  },
  {
    "name": "Find removable storage devices using System Events",
    "command": "tell application \"System Events\" to get name of every disk whose ejectable is true\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "This test uses System Events to find all connected removable storage devices.",
    "technique_id": "T1120",
    "technique_name": "Peripheral Device Discovery",
    "test_number": 1
  },
  {
    "name": "Find removable storage devices using Finder",
    "command": "tell application \"Finder\" to get name of every disk whose ejectable is true\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "This test uses Finder to find all connected removable storage devices.",
    "technique_id": "T1120",
    "technique_name": "Peripheral Device Discovery",
    "test_number": 2
  },
  {
    "name": "Find all devices using System Information",
    "command": "tell application \"System Information\" to get properties",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "This test uses System Information to find all connected devices (bluetooth, wifi, disks, application versions, etc.).",
    "technique_id": "T1120",
    "technique_name": "Peripheral Device Discovery",
    "test_number": 3
  },
  {
    "name": "Display dialog box to capture user password",
    "command": "display dialog \"#{description}\" with title \"#{title}\" default answer \"\" with icon caution buttons {\"Continue\"} default button \"Continue\" with hidden answer\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Removes a specified login item from the user's login items list. This can be used to clean up persistence mechanisms or remove unwanted autostart entries.",
    "technique_id": "T1056.002",
    "technique_name": "Input Capture: GUI Input Capture",
    "test_number": 1
  },
  {
    "name": "Shutdown system (using System Events)",
    "command": "tell application \"System Events\" to shutdown",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Shuts down the system using the shutdown command from System Events.",
    "technique_id": "T1529",
    "technique_name": "System Shutdown/Reboot",
    "test_number": 1
  },
  {
    "name": "Reboot system (using System Events)",
    "command": "tell application \"System Events\" to reboot",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Reboots the system using the reboot command from System Events.",
    "technique_id": "T1529",
    "technique_name": "System Shutdown/Reboot",
    "test_number": 2
  },
  {
    "name": "Delete a login item",
    "command": "tell application \"System Events\" to delete login item \"#{loginItemName}\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Removes a specified login item from the user's login items list. This can be used to clean up persistence mechanisms or remove unwanted autostart entries.",
    "technique_id": "T1070.009",
    "technique_name": "Indicator Removal: Clear Persistence",
    "test_number": 1
  },
  {
    "name": "List files and directories in Macintosh HD",
    "command": "tell application \"Finder\" to get name of every item of folder POSIX file \"#{folderName}\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Enumerate files and directories in the root filesystem using Finder application via AppleScript",
    "technique_id": "T1083",
    "technique_name": "File and Directory Discovery",
    "test_number": 1
  },
  {
    "name": "List files and directories in root directory",
    "command": "list folder \"#{folderName}\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Perform directory listing of root filesystem using AppleScript list folder command",
    "technique_id": "T1083",
    "technique_name": "File and Directory Discovery",
    "test_number": 2
  },
  {
    "name": "Get system information",
    "command": "system info\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves comprehensive system information including OS version, hardware details, and system configuration using the system info command. This provides detailed system reconnaissance capabilities without requiring elevated privileges.",
    "technique_id": "T1082",
    "technique_name": "System Information Discovery",
    "test_number": 1
  },
  {
    "name": "Get disks",
    "command": "list disks",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Lists all connected disks on the system using the list disks command.",
    "technique_id": "T1082",
    "technique_name": "System Information Discovery",
    "test_number": 2
  },
  {
    "name": "Search for passwords in history files",
    "command": "set homeDir to (path to home folder as text)\nset historyPath to homeDir & \"#{filename}\"\n\ntry\n    set fileContent to read file historyPath\n    set lineList to paragraphs of fileContent\n    set matchCount to 0\n    set matchList to {}\n\n    repeat with currentLine in lineList\n        set lineText to currentLine as string\n\n        if lineText starts with \": \" and lineText contains \";\" then\n            set semicolonPos to offset of \";\" in lineText\n            if semicolonPos > 0 then\n                set lineText to text (semicolonPos + 1) thru -1 of lineText\n            end if\n        end if\n\n        if lineText contains \"#{searchTerm}\" then\n            set matchCount to matchCount + 1\n            if matchCount â‰¤ 10 then\n                set end of matchList to lineText\n            end if\n        end if\n    end repeat\n\n    return \"Found \" & matchCount & \" matches:\" & return & (matchList as string)\non error errMsg\n    return \"Error: \" & errMsg\nend try\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "This test searches for passwords in the bash history file.",
    "technique_id": "T1552.003",
    "technique_name": "Unsecured Credentials: Bash History",
    "test_number": 1
  },
  {
    "name": "Get all processes",
    "command": "tell application \"System Events\" to get name of every process\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves a list of all running processes on the system using System Events. This provides comprehensive process enumeration capabilities and may require TCC approval for System Events access.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 1
  },
  {
    "name": "Get all application processes (User facing applications)",
    "command": "tell application \"System Events\"\n  set runningApps to name of every application process\n  repeat with appName in runningApps\n    log appName\n  end repeat\nend tell",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves only user-facing application processes (excluding system processes and daemons). This focuses on applications that users typically interact with and may require TCC approval for System Events access.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 2
  },
  {
    "name": "Get list of running processes using AppKit",
    "command": "use framework \"AppKit\"\nuse framework \"Foundation\"\n\nset r to {}\nset activeApps to current application's NSWorkspace's sharedWorkspace's runningApplications()\nrepeat with anApp in activeApps\n    try\n        set this_app to anApp's localizedName() as text\n        if this_app is not missing value and this_app is not \"\" then\n            set end of r to this_app\n        end if\n    on error\n        -- Skip apps without names\n    end try\nend repeat\nreturn r",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves running applications using AppKit framework.",
    "technique_id": "T1057",
    "technique_name": "Process Discovery",
    "test_number": 3
  },
  {
    "name": "Enumerate Local Accounts",
    "command": "tell application \"System Events\" to get name of every user",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Adversaries may attempt to get a listing of local system accounts.",
    "technique_id": "T1087.001",
    "technique_name": "Account Discovery: Local Account",
    "test_number": 1
  },
  {
    "name": "Copy Apple Notes database",
    "command": "tell application \"Finder\"\n  set destinationFolderPath to POSIX file \"#{destination_path}\"\n  set notesFolderPath to (path to home folder as text) & \"Library:Group Containers:group.com.apple.notes:\"\n  set notesFolder to folder notesFolderPath\n  set notesFiles to {file \"NoteStore.sqlite\", file \"NoteStore.sqlite-shm\", file \"NoteStore.sqlite-wal\"} of notesFolder\n  repeat with aFile in notesFiles\n    duplicate aFile to folder destinationFolderPath with replacing\n  end repeat\nend tell\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "This command will copy Safari BinaryCookies files using AppleScript as seen in Atomic Stealer.",
    "technique_id": "T1005",
    "technique_name": "Data from Local System",
    "test_number": 1
  },
  {
    "name": "Create a login item",
    "command": "tell application \"System Events\" to make login item at end with properties {path:\"#{itemPath}\", hidden:\"#{isHidden}\"}\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Creates a new login item that will automatically start when the user logs in.",
    "technique_id": "T1547.015",
    "technique_name": "Boot or Logon Autostart Execution: Login Items",
    "test_number": 1
  },
  {
    "name": "Discover login items",
    "command": "tell application \"System Events\" to get name of every login item\ntell application \"System Events\" to get the hidden of every login item\ntell application \"System Events\" to get the path of every login item",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Lists all login items.",
    "technique_id": "T1547.015",
    "technique_name": "Boot or Logon Autostart Execution: Login Items",
    "test_number": 2
  },
  {
    "name": "Get user (using System Info)",
    "command": "short user name of (system info)\nlong user name of (system info)\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current user's short and long names using the system info command.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 1
  },
  {
    "name": "Get user (using environment variable)",
    "command": "system attribute \"USER\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current user's username using the USER environment variable.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 2
  },
  {
    "name": "Get user (using list folder)",
    "command": "list folder \"/Users\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "By default, the user's home directory is /Users/username.\nListing the /Users folder will return the list of users on the system.\n",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 3
  },
  {
    "name": "Get user information (using System Events JXA)",
    "command": "const app = Application(\"System Events\")\nconst user = app.currentUser();\nconst longName = user.fullName();\nconst shortName = user.name();\nconst userHome = user.homeDirectory();\n\n`Name: ${longName}\nUsername: ${shortName}\nHome Directory: ${userHome}`",
    "language": "JavaScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves the current user's username using the System Events JXA command.",
    "technique_id": "T1033",
    "technique_name": "System Owner/User Discovery",
    "test_number": 4
  },
  {
    "name": "Check XProtect version",
    "command": "use framework \"Foundation\"\nset plistPath to \"/Library/Apple/System/Library/CoreServices/XProtect.bundle/Contents/Info.plist\"\nset plistURL to current application's NSURL's fileURLWithPath:plistPath\nset plistDict to current application's NSDictionary's dictionaryWithContentsOfURL:plistURL\nset bundleVersion to plistDict's objectForKey:\"CFBundleShortVersionString\"\nreturn bundleVersion as string",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "This test checks the version of XProtect, the built-in antivirus in macOS. XCSSET checks whether the version of XProtect is less than 5287.",
    "technique_id": "T1518.001",
    "technique_name": "Security Software Discovery",
    "test_number": 1
  },
  {
    "name": "Hide Application Window",
    "command": "tell application \"#{applicationName}\" to set visible of front window to false\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Hides the Application window",
    "technique_id": "T1564.003",
    "technique_name": "Hide Artifacts: Hidden Window",
    "test_number": 1
  },
  {
    "name": "Get System Time",
    "command": "current date",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "An adversary may gather the system time and/or time zone settings from a local or remote system.",
    "technique_id": "T1124",
    "technique_name": "System Time Discovery",
    "test_number": 1
  },
  {
    "name": "Get clipboard content (using System Events)",
    "command": "tell application \"System Events\" to get the clipboard",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Retrieves the current clipboard content using System Events.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 1
  },
  {
    "name": "Set clipboard content (using System Events)",
    "command": "tell application \"System Events\" to set the clipboard to \"#{clipboardContent}\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Sets the clipboard content to a specified value using System Events.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 2
  },
  {
    "name": "Get clipboard content (using AppleScript defaults)",
    "command": "the clipboard",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves the current clipboard content using AppleScript's built-in clipboard command.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 3
  },
  {
    "name": "Set clipboard content (using AppleScript defaults)",
    "command": "set the clipboard to \"#{textContent}\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Sets the clipboard content to a specified value using AppleScript's built-in clipboard command.",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 4
  },
  {
    "name": "Get clipboard content (using Cocoa)",
    "command": "use framework \"Foundation\"\nuse framework \"AppKit\"\n\nset pasteboard to current application's NSPasteboard's generalPasteboard()\nset clipboardContent to pasteboard's stringForType:\"public.utf8-plain-text\"\nclipboardContent\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Retrieves clipboard content using Cocoa frameworks (Foundation and AppKit).",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 5
  },
  {
    "name": "Set clipboard content (using Cocoa)",
    "command": "use framework \"Foundation\"\nuse framework \"AppKit\"\n\nset pasteboard to current application's NSPasteboard's generalPasteboard()\npasteboard's setString:\"#{textContent}\" forType:\"public.utf8-plain-text\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Sets clipboard content using Cocoa frameworks (Foundation and AppKit).",
    "technique_id": "T1115",
    "technique_name": "Clipboard Data",
    "test_number": 6
  },
  {
    "name": "Take screenshot",
    "command": "tell application \"System Events\" to key code 20 using {command down, shift down}",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Capture screenshot using System Events",
    "technique_id": "T1113",
    "technique_name": "Input Capture",
    "test_number": 1
  },
  {
    "name": "Copy Safari BinaryCookies",
    "command": "tell application \"Finder\"\n  set destinationFolderPath to POSIX file \"#{destination_path}\"\n  set safariFolder to ((path to library folder from user domain as text) & \"Containers:com.apple.Safari:Data:Library:Cookies:\")\n  duplicate file \"Cookies.binarycookies\" of folder safariFolder to folder destinationFolderPath with replacing\nend tell\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "This command will copy Safari BinaryCookies files using AppleScript as seen in Atomic Stealer.",
    "technique_id": "T1539",
    "technique_name": "Steal Web Session Cookie",
    "test_number": 1
  },
  {
    "name": "Open application",
    "command": "tell application \"#{applicationName}\" to activate\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Opens an application on the system. The application will be in focus after running the command.",
    "technique_id": "T1059.002",
    "technique_name": "Command and Scripting Interpreter: AppleScript",
    "test_number": 1
  },
  {
    "name": "Launch application",
    "command": "tell application \"#{applicationName}\" to launch\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Lauches an application on the system. The application will be in the background after running the command.",
    "technique_id": "T1059.002",
    "technique_name": "Command and Scripting Interpreter: AppleScript",
    "test_number": 2
  },
  {
    "name": "Close application",
    "command": "tell application \"#{applicationName}\" to close windows\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Closes an application on the system.",
    "technique_id": "T1059.002",
    "technique_name": "Command and Scripting Interpreter: AppleScript",
    "test_number": 3
  },
  {
    "name": "Delete system log files",
    "command": "tell application \"Finder\" to delete POSIX file \"#{logPath}\"\n",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "This test deletes the system log file using Finder application.",
    "technique_id": "T1070.002",
    "technique_name": "Indicator Removal on Host: Clear FreeBSD, Linux or Mac System Logs",
    "test_number": 1
  },
  {
    "name": "Read local hosts file",
    "command": "read POSIX file \"/etc/hosts\"",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": false,
    "description": "Adversaries may analyze data from local host file (/etc/hosts)",
    "technique_id": "T1018",
    "technique_name": "Remote System Discovery",
    "test_number": 1
  },
  {
    "name": "Stop Application",
    "command": "tell application \"#{applicationName}\" to quit",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "Adversaries may stop or disable services on a system to render those services unavailable to legitimate users.",
    "technique_id": "T1489",
    "technique_name": "Service Stop",
    "test_number": 1
  },
  {
    "name": "Find all running applications which currently have a window",
    "command": "tell application \"System Events\" to get name of every process whose background only is false",
    "language": "AppleScript",
    "elevation_required": false,
    "tcc_required": true,
    "description": "This test uses System Events to find all running applications that currently have a window.",
    "technique_id": "T1010",
    "technique_name": "Application Window Discovery",
    "test_number": 1
  }
]
