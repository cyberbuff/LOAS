---
title: T1033
description: "System Owner/User Discovery"
---

## Description from ATT&CK



Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Various utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.

On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show users` and `show ssh` can be used to display users currently logged into the device.(Citation: show_ssh_users_cmd_cisco)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)


## Atomic Tests

### Atomic Test #1 - Get user (using System Info)

Retrieves the current user's short and long names using the system info command.


```applescript tab="<Code /> Script"
short user name of (system info)
long user name of (system info)

```


```bash tab="<Terminal /> Execution"
osascript -e 'short user name of (system info)' -e 'long user name of (system info)'
```

#### Download Files

<DownloadButton filename="get_user_using_system_info.scpt" directory="T1033" type="scpt" label="Download .scpt" />
<DownloadButton filename="get_user_using_system_info.swift" directory="T1033" type="swift" label="Download .swift" />
<DownloadButton filename="get_user_using_system_info" directory="T1033" type="binary" label="Download Binary" />
<DownloadButton filename="get_user_using_system_info.app" directory="T1033" type="app" label="Download .app" />

---

### Atomic Test #2 - Get user (using environment variable)

Retrieves the current user's username using the USER environment variable.


```applescript tab="<Code /> Script"
return (system attribute "USER")

```


```bash tab="<Terminal /> Execution"
osascript -e 'return (system attribute "USER")'
```

#### Download Files

<DownloadButton filename="get_user_using_environment_variable.scpt" directory="T1033" type="scpt" label="Download .scpt" />
<DownloadButton filename="get_user_using_environment_variable.swift" directory="T1033" type="swift" label="Download .swift" />
<DownloadButton filename="get_user_using_environment_variable" directory="T1033" type="binary" label="Download Binary" />
<DownloadButton filename="get_user_using_environment_variable.app" directory="T1033" type="app" label="Download .app" />

---

### Atomic Test #3 - Get user (using list folder)

By default, the user's home directory is /Users/username.
Listing the /Users folder will return the list of users on the system.



```applescript tab="<Code /> Script"
return (list folder "/Users")
```


```bash tab="<Terminal /> Execution"
osascript -e 'return (list folder "/Users")'
```

#### Download Files

<DownloadButton filename="get_user_using_list_folder.scpt" directory="T1033" type="scpt" label="Download .scpt" />
<DownloadButton filename="get_user_using_list_folder.swift" directory="T1033" type="swift" label="Download .swift" />
<DownloadButton filename="get_user_using_list_folder" directory="T1033" type="binary" label="Download Binary" />
<DownloadButton filename="get_user_using_list_folder.app" directory="T1033" type="app" label="Download .app" />

---

### Atomic Test #4 - Get user information (using System Events JXA)

Retrieves the current user's username using the System Events JXA command.

**Requirements:**

- TCC Required: âœ…


```javascript tab="<Code /> Script"
const app = Application("System Events")
const user = app.currentUser();
const longName = user.fullName();
const shortName = user.name();
const userHome = user.homeDirectory();

`Name: ${longName}
Username: ${shortName}
Home Directory: ${userHome}`
```


```bash tab="<Terminal /> Execution"
osascript -l JavaScript -e 'const app = Application("System Events")' -e 'const user = app.currentUser();' -e 'const longName = user.fullName();' -e 'const shortName = user.name();' -e 'const userHome = user.homeDirectory();' -e '`Name: ${longName}' -e 'Username: ${shortName}' -e 'Home Directory: ${userHome}`'
```

#### Download Files

<DownloadButton filename="get_user_information_using_system_events_jxa.js" directory="T1033" type="js" label="Download .js" />
<DownloadButton filename="get_user_information_using_system_events_jxa.swift" directory="T1033" type="swift" label="Download .swift" />
<DownloadButton filename="get_user_information_using_system_events_jxa" directory="T1033" type="binary" label="Download Binary" />
<DownloadButton filename="get_user_information_using_system_events_jxa.app" directory="T1033" type="app" label="Download .app" />

## References

- [MITRE ATT&CK T1033](https://attack.mitre.org/techniques/T1033/)
- [Apple Script Language Guide](https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html)
