---
title: T1059.002
description: "Command and Scripting Interpreter  AppleScript"
---

## Description from ATT&CK



Adversaries may abuse AppleScript for execution. AppleScript is a macOS scripting language designed to control applications and parts of the OS via inter-application messages called AppleEvents.(Citation: Apple AppleScript) These AppleEvent messages can be sent independently or easily scripted with AppleScript. These events can locate open windows, send keystrokes, and interact with almost any open application locally or remotely.

Scripts can be run from the command-line via <code>osascript /path/to/script</code> or <code>osascript -e "script here"</code>. Aside from the command line, scripts can be executed in numerous ways including Mail rules, Calendar.app alarms, and Automator workflows. AppleScripts can also be executed as plain text shell scripts by adding <code>#!/usr/bin/osascript</code> to the start of the script file.(Citation: SentinelOne AppleScript)

AppleScripts do not need to call <code>osascript</code> to execute. However, they may be executed from within mach-O binaries by using the macOS [Native API](https://attack.mitre.org/techniques/T1106)s <code>NSAppleScript</code> or <code>OSAScript</code>, both of which execute code independent of the <code>/usr/bin/osascript</code> command line utility.

Adversaries may abuse AppleScript to execute various behaviors, such as interacting with an open SSH connection, moving to remote machines, and even presenting users with fake dialog boxes. These events cannot start applications remotely (they can start them locally), but they can interact with applications if they're already running remotely. On macOS 10.10 Yosemite and higher, AppleScript has the ability to execute [Native API](https://attack.mitre.org/techniques/T1106)s, which otherwise would require compilation and execution in a mach-O binary file format.(Citation: SentinelOne macOS Red Team) Since this is a scripting language, it can be used to launch more common techniques as well such as a reverse shell via [Python](https://attack.mitre.org/techniques/T1059/006).(Citation: Macro Malware Targets Macs)


## Atomic Tests

### Atomic Test #1 - Display dialog box to capture user password

Removes a specified login item from the user's login items list. This can be used to clean up persistence mechanisms or remove unwanted autostart entries.

**Requirements:**

- TCC Required: ✅

**Input Arguments:**

| Argument | Type | Default Value |
|----------|------|---------------|
| title | str | `Auto-Updates System` |
| description | str | `The launcher needs permissions to enable background auto-updates.Please enter your password.` |


```applescript tab="<Code /> Script"
display dialog "The launcher needs permissions to enable background auto-updates.Please enter your password." with title "Auto-Updates System" default answer "" with icon caution buttons {"Continue"} default button "Continue" with hidden answer

```


```bash tab="<Terminal /> Execution"
# Execute with default arguments
osascript -e 'display dialog "The launcher needs permissions to enable background auto-updates.Please enter your password." with title "Auto-Updates System" default answer "" with icon caution buttons {"Continue"} default button "Continue" with hidden answer'

# Or save to file and execute
osascript t1059.002_1.scpt

# With custom arguments
osascript t1059.002_1.scpt "Auto-Updates System" "The launcher needs permissions to enable background auto-updates.Please enter your password."
```

**Download Files**

<DownloadButton filename="display_dialog_box_to_capture_user_password.scpt" type="scpt" label="Download .scpt" />
<DownloadButton filename="display_dialog_box_to_capture_user_password.swift" type="swift" label="Download .swift" />
<DownloadButton filename="display_dialog_box_to_capture_user_password" type="binary" label="Download Binary" />
<DownloadButton filename="display_dialog_box_to_capture_user_password.app" type="app" label="Download Applet" />

---

### Atomic Test #2 - Open application

Opens an application on the system. The application will be in focus after running the command.

**Requirements:**

- TCC Required: ✅

**Input Arguments:**

| Argument | Type | Default Value |
|----------|------|---------------|
| applicationName | str | `Finder` |


```applescript tab="<Code /> Script"
tell application "Finder" to activate

```


```bash tab="<Terminal /> Execution"
# Execute with default arguments
osascript -e 'tell application "Finder" to activate'

# Or save to file and execute
osascript t1059.002_2.scpt

# With custom arguments
osascript t1059.002_2.scpt "Finder"
```

**Download Files**

<DownloadButton filename="open_application.scpt" type="scpt" label="Download .scpt" />
<DownloadButton filename="open_application.swift" type="swift" label="Download .swift" />
<DownloadButton filename="open_application" type="binary" label="Download Binary" />
<DownloadButton filename="open_application.app" type="app" label="Download Applet" />

---

### Atomic Test #3 - Launch application

Lauches an application on the system. The application will be in the background after running the command.

**Requirements:**

- TCC Required: ✅

**Input Arguments:**

| Argument | Type | Default Value |
|----------|------|---------------|
| applicationName | str | `Finder` |


```applescript tab="<Code /> Script"
tell application "Finder" to launch

```


```bash tab="<Terminal /> Execution"
# Execute with default arguments
osascript -e 'tell application "Finder" to launch'

# Or save to file and execute
osascript t1059.002_3.scpt

# With custom arguments
osascript t1059.002_3.scpt "Finder"
```

**Download Files**

<DownloadButton filename="launch_application.scpt" type="scpt" label="Download .scpt" />
<DownloadButton filename="launch_application.swift" type="swift" label="Download .swift" />
<DownloadButton filename="launch_application" type="binary" label="Download Binary" />
<DownloadButton filename="launch_application.app" type="app" label="Download Applet" />

---

### Atomic Test #4 - Close application

Closes an application on the system.

**Requirements:**

- TCC Required: ✅

**Input Arguments:**

| Argument | Type | Default Value |
|----------|------|---------------|
| applicationName | str | `Finder` |


```applescript tab="<Code /> Script"
tell application "Finder" to close windows

```


```bash tab="<Terminal /> Execution"
# Execute with default arguments
osascript -e 'tell application "Finder" to close windows'

# Or save to file and execute
osascript t1059.002_4.scpt

# With custom arguments
osascript t1059.002_4.scpt "Finder"
```

**Download Files**

<DownloadButton filename="close_application.scpt" type="scpt" label="Download .scpt" />
<DownloadButton filename="close_application.swift" type="swift" label="Download .swift" />
<DownloadButton filename="close_application" type="binary" label="Download Binary" />
<DownloadButton filename="close_application.app" type="app" label="Download Applet" />

## References

- [MITRE ATT&CK T1059.002](https://attack.mitre.org/techniques/T1059/002/)
- [Apple Script Language Guide](https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html)
